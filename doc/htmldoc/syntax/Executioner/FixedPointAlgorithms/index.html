<!DOCTYPE html><head><meta charset="UTF-8"><title>Fixed point iteration algorithms | Aurora App</title><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://aurora-multiphysics.github.io/aurora/" class="left moose-logo hide-on-med-and-down">Aurora App</a><a href="https://github.com/aurora-multiphysics/aurora" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="2568efdf-8d3e-4469-b2d3-172cfec9a1bf"><i class="material-icons">menu</i></a><ul class="sidenav" id="2568efdf-8d3e-4469-b2d3-172cfec9a1bf"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://aurora-multiphysics.github.io/aurora/" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="../.." class="breadcrumb">syntax</a><a href=".." class="breadcrumb">Executioner</a><a href="." class="breadcrumb">FixedPointAlgorithms</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="d9252de9-2a32-4a67-b9e8-a473f5970b7c" data-section-level="1" data-section-text="Fixed point iteration algorithms"><h1 id="fixed-point-iteration-algorithms">Fixed point iteration algorithms</h1><p>MOOSE provides fixed point algorithms in all its executioners. This can be used to iterate a single application solve to converge a parameter, for example converge the mass flow rate of a fluid simulation with a target pressure drop. But it is more often used to tightly couple multiphysics simulations, where the <code>MultiApp</code> system is leveraged to couple two different problems, and iterating each application, transferring information between each solve, brings the coupling to convergence.</p><p>Within one app coupling iteration, MultiApps executed on <code>TIMESTEP_BEGIN</code>, the main app and MultiApps executed on <code>TIMESTEP_END</code> are executed, in that order. The execution order of MultiApps within one group (<code>TIMESTEP_BEGIN</code> or <code>TIMESTEP_END</code>) is undefined. The relevant data transfers happen before and after each of the two groups of MultiApps runs. Because the <code>MultiApp</code> system allows for wrapping another levels of MultiApps, the design enables multi-level app coupling iterations automatically.</p><p>Regardless of the fixed point algorithm used, solution vectors can be relaxed to improve the stability of the convergence. When a <code>MultiApp</code> has its own sub-apps, MOOSE allows relaxation of the <code>MultiApp</code> solution within the main coupling iterations and within the secondary coupling iterations, where the <code>MultiApp</code> is the main app, independently.</p><p>Relaxation, or acceleration (cf secant/Steffensen&#x27;s method), is performed on variables or postprocessors. These two objects encompass most of the data transfers that are performed when coupling several applications.</p><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>The fixed point iteration algorithms work to converge within a time step. The previous time step solution is not modified, The Picard, secant and Steffensen algorithm do not lag part or all of the solution vector. Lagging can still be achieved using postprocessors, auxiliary variables, or other constructs, and transferring them at the beginning / end of a time step.</p></p></div></div></div><section class="scrollspy" id="ba80365d-b8f4-400a-8fa8-c9cc193600f8" data-section-level="2" data-section-text="Picard fixed point iterations"><h2 id="picard-fixed-point-iterations">Picard fixed point iterations</h2><p>Picard iterations are the default fixed point iteration algorithm. They may be relaxed, with a relaxation factor specified for the main application in the <code>Executioner</code> block, and a relaxation factor specified for each <code>MultiApp</code> in their respective block.</p><p>Relaxed Picard fixed point iterations may be described by:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-f662410a-20bc-4540-8844-22eaf69217c8"></span><script>var element = document.getElementById("moose-equation-f662410a-20bc-4540-8844-22eaf69217c8");katex.render("x_{n+1} = \\alpha f(x_n) + (1 - \\alpha) x_n", element, {displayMode:true,throwOnError:false});</script></span><p>with <span class="moose-katex-inline-equation" id="moose-equation-412aa694-3623-41d7-acb1-62d405a49c49"><script>var element = document.getElementById("moose-equation-412aa694-3623-41d7-acb1-62d405a49c49");katex.render("x_n", element, {displayMode:false,throwOnError:false});</script></span> the specified variable/postprocessor, <span class="moose-katex-inline-equation" id="moose-equation-b29b256a-795d-4c21-9c37-5d0c7aea7d62"><script>var element = document.getElementById("moose-equation-b29b256a-795d-4c21-9c37-5d0c7aea7d62");katex.render("f", element, {displayMode:false,throwOnError:false});</script></span> a function representing the coupled problem and <span class="moose-katex-inline-equation" id="moose-equation-65c5adf8-728b-4c72-8ea9-4b92f893f8c8"><script>var element = document.getElementById("moose-equation-65c5adf8-728b-4c72-8ea9-4b92f893f8c8");katex.render("\\alpha", element, {displayMode:false,throwOnError:false});</script></span> the relaxation factor.</p><p>Convergence of Picard iterations is expected to be linear when it converges. The Picard-Lindelhof theorem provides a set of conditions under which convergence is guaranteed.</p></section><section class="scrollspy" id="5c15abf0-6401-4c86-93d8-c00810d45cd4" data-section-level="2" data-section-text="Secant method"><h2 id="secant-method">Secant method</h2><p>The secant method is a root finding technique which follows secant lines to find the roots of a function <span class="moose-katex-inline-equation" id="moose-equation-6894240a-879a-499a-82aa-143846b0c9e5"><script>var element = document.getElementById("moose-equation-6894240a-879a-499a-82aa-143846b0c9e5");katex.render("f", element, {displayMode:false,throwOnError:false});</script></span>. It is adapted here for fixed point iterations. The secant method may be described by:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-50c54590-fece-4c80-b55c-2353bfc33cce"></span><script>var element = document.getElementById("moose-equation-50c54590-fece-4c80-b55c-2353bfc33cce");katex.render("x_{n+1} = x_n - \\dfrac{(f(x_n) - x_n) * (x_n - x_{n-1})}{f(x_n) - x_n - f(x_{n-1}) + x_{n-1}}", element, {displayMode:true,throwOnError:false});</script></span><p>with the same conventions as above. The relaxation factor, if used, is not shown here. The secant method is easily understood for 1D problems, where <span class="moose-katex-inline-equation" id="moose-equation-d47bc711-93ff-47df-9d6d-77aa44d9b4d0"><script>var element = document.getElementById("moose-equation-d47bc711-93ff-47df-9d6d-77aa44d9b4d0");katex.render("(x_n, f(x_n) - x_n)", element, {displayMode:false,throwOnError:false});</script></span> are the coordinates of the points used to draw the secant, of slope <span class="moose-katex-inline-equation" id="moose-equation-e45ddaad-077c-497f-9478-12a34ff9a7b2"><script>var element = document.getElementById("moose-equation-e45ddaad-077c-497f-9478-12a34ff9a7b2");katex.render("\\dfrac{x_n - x_{n-1}}{(f(x_n) - x_n) - (f(x_{n-1}) - x_{n-1})}", element, {displayMode:false,throwOnError:false});</script></span>.</p><p>Convergence of the secant method is expected to be super-linear when it converges, with an order of <span class="moose-katex-inline-equation" id="moose-equation-d3ecc564-8f57-4aad-b1eb-b58557f75fc7"><script>var element = document.getElementById("moose-equation-d3ecc564-8f57-4aad-b1eb-b58557f75fc7");katex.render("\\dfrac{1 + \\sqrt{5}}{2}", element, {displayMode:false,throwOnError:false});</script></span>. Some conditions for this convergence rate is that the equations are twice differentiable in their inputs, with a fixed point multiplicity of one. Oscillatory functions and poor initial guesses can prevent convergence.</p></section><section class="scrollspy" id="8a0286dc-9e9c-4e36-bed4-e687dac5d51f" data-section-level="2" data-section-text="Steffensen ' s method"><h2 id="steffensen-s-method">Steffensen&#x27;s method</h2><p>Steffensen&#x27;s method is a root finding technique based on perturbating a solution at a given point to approximate the local derivative, such that:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-d091c191-af62-4c27-b42c-25211625589f"></span><script>var element = document.getElementById("moose-equation-d091c191-af62-4c27-b42c-25211625589f");katex.render("g(x_{n}) = \\dfrac{f(x_{n} + f(x_{n}))}{f(x_{n})}", element, {displayMode:true,throwOnError:false});</script></span><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-f60be13e-4f40-4f26-a8f1-b4ccd34ff5e3"></span><script>var element = document.getElementById("moose-equation-f60be13e-4f40-4f26-a8f1-b4ccd34ff5e3");katex.render("x_{n+1} = x_n - \\dfrac{f(x_n)}{g(x_{n})}", element, {displayMode:true,throwOnError:false});</script></span><p>The update is then similar to Newton&#x27;s method which uses the exact derivative.</p><p>Convergence of Steffensen&#x27;s method is expected to be quadratic when it converges. However because it requires two evaluations of the coupled problem before computing the next term, this method is expected to be slower than the secant method. A poor initial guesses can also prevent convergence.</p><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>When using the secant or Steffensen&#x27;s methods, only specify variables and postprocessors from either the main application or the sub-applications to be accelerated. Specifying variables or postprocessors to be updated using the acceleration method in both applications will not provide as much acceleration, due to the current implementation of the methods. Future work may remove this limitation.</p></p></div></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#ba80365d-b8f4-400a-8fa8-c9cc193600f8" class="tooltipped" data-position="left" data-tooltip="Picard fixed point iterations">Picard fixed point iterations</a></li><li><a href="#5c15abf0-6401-4c86-93d8-c00810d45cd4" class="tooltipped" data-position="left" data-tooltip="Secant method">Secant method</a></li><li><a href="#8a0286dc-9e9c-4e36-bed4-e687dac5d51f" class="tooltipped" data-position="left" data-tooltip="Steffensen ' s method">Steffensen ' s method</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script>